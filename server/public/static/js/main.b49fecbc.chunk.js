(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{33:function(e,t,a){e.exports=a(45)},38:function(e,t,a){},39:function(e,t,a){},45:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),s=a(28),l=a.n(s),r=(a(38),a(9)),o=a(10),c=a(14),u=a(11),m=a(7),h=a(13),d=(a(39),a(18)),p=a(15),g=a(19),E=a(47),f=a(48),b=a(51),v=a(50),y=a(46),k=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){a.setState(Object(g.a)({},e.target.id,e.target.value))},a.register=function(e){a.setState({registerForm:!0})},a.backToLogin=function(e){a.setState({registerForm:!1})},a.handleLogin=function(e){a.setState({isLoading:!0}),e.preventDefault();var t=a.state,n=t.email,i=t.password;fetch("/api/account/signin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:i})}).then(function(e){return e.json()}).then(function(e){e.success?(a.props.saveToken(e.token),localStorage.setItem("tokenItem",e.token),a.setState({toHome:!0,isLoading:!1})):(a.setState({signUpError:e.message}),alert("invalid login"))})},a.handleSubmit=function(e){a.setState({isLoading:!0}),e.preventDefault();var t=a.state,n=t.email,i=t.password,s=t.username;fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:i,username:s})}).then(function(e){return e.json()}).then(function(e){e.success?(a.setState({signUpError:e.message,isLoading:!1,email:"",password:"",username:""}),a.setState({registerForm:!1})):(a.setState({signUpError:e.message,isLoading:!1}),alert("Username or email taken! Try again."))})},a.state={email:"",password:"",username:"",isLoading:!0,signUpError:"",registerForm:!1,token:a.props.token,validSession:!1,toHome:!1},a}return Object(h.a)(t,e),Object(o.a)(t,[{key:"validateForm",value:function(){return this.state.email.length>0&&this.state.password.length>0}},{key:"componentDidMount",value:function(){var e=this;this.setState({isLoading:!0}),fetch("/api/account/verify",{method:"GET",headers:{"Content-Type":"application/json",token:this.state.token}}).then(function(e){return e.json()}).then(function(t){t.success?e.setState({validSession:!0}):e.setState({validSession:!1}),e.setState({isLoading:!1})})}},{key:"render",value:function(){return this.state.toHome?i.a.createElement(p.a,{to:"/home"}):this.state.isLoading?i.a.createElement(y.a,null," ",i.a.createElement("div",{className:"text-center"},i.a.createElement("h2",{className:"text-center"},"Loading ... ")," ")):this.state.registerForm?i.a.createElement(y.a,null,i.a.createElement("div",{className:"Login"},i.a.createElement("form",{onSubmit:this.handleSubmit},i.a.createElement(E.a,{controlId:"email",bsSize:"large"},i.a.createElement(f.a,null,"Email  "),i.a.createElement(b.a,{autoFocus:!0,type:"email",value:this.state.email,onChange:this.handleChange})),i.a.createElement(E.a,{controlId:"username",bsSize:"large"},i.a.createElement(f.a,null,"Username  "),i.a.createElement(b.a,{value:this.state.username,onChange:this.handleChange,type:"username"})),i.a.createElement(E.a,{controlId:"password",bsSize:"large"},i.a.createElement(f.a,null,"Password  "),i.a.createElement(b.a,{value:this.state.password,onChange:this.handleChange,type:"password"})),i.a.createElement(v.a,{block:!0,bsSize:"large",disabled:!this.validateForm(),type:"submit"},"Register"),i.a.createElement("br",null),i.a.createElement(v.a,{block:!0,bsSize:"small",type:"submit",onClick:this.backToLogin},"Go Back")))):this.state.token&&!1!==this.state.validSession?i.a.createElement("div",null,i.a.createElement("p",null,"Signed in"),i.a.createElement("div",null,i.a.createElement(p.a,{to:"/home"}))):i.a.createElement(y.a,null,i.a.createElement("div",null,i.a.createElement("p",null,"Login in here: "),i.a.createElement("form",{onSubmit:this.handleLogin},i.a.createElement(E.a,{controlId:"email",bsSize:"large"},i.a.createElement(f.a,null,"Email  "),i.a.createElement(b.a,{autoFocus:!0,type:"email",value:this.state.email,onChange:this.handleChange})),i.a.createElement(E.a,{controlId:"password",bsSize:"large"},i.a.createElement(f.a,null,"Password  "),i.a.createElement(b.a,{value:this.state.password,onChange:this.handleChange,type:"password"})),i.a.createElement(v.a,{block:!0,bsSize:"large",disabled:!this.validateForm(),type:"submit"},"Login")),i.a.createElement("br",null),i.a.createElement(v.a,{block:!0,bsSize:"large",type:"button",onClick:this.register},"Register")))}}]),t}(n.Component),S=a(23),C=a(32),j=a(49),O=function(e){return i.a.createElement(y.a,null,i.a.createElement("h1",null,e.title)," ",i.a.createElement("p",null,"by ",e.user)," ",i.a.createElement("img",{className:"img-fluid",src:e.imgSrc})," ",e.elements," ",i.a.createElement("br",null)," ",i.a.createElement("p",null,e.longDesc),i.a.createElement("p",null,e.instructions),i.a.createElement("br",null),i.a.createElement(v.a,{onClick:e.goBack},"Go Back"))},T=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){a.setState({isLoading:!0}),e.preventDefault();var t=a.state,n=t.title,i=t.shortDesc,s=t.longDesc,l=t.ingredients,r=t.instructions,o=t.imageURL,c=l.replace(/\s*,\s*/g,",").split(",");c=c.map(function(e){return""+e[0].toUpperCase()+e.slice(1)}),fetch("/api/recipes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:a.props.user,title:n,description:i,longDescription:s,ingredients:c,instructions:r,image:o})}).then(function(e){return e.json()}).then(function(e){e.success?(alert("Recipi saved!"),a.props.goBack()):alert("Failed! Server error.")})},a.handleChange=function(e){a.setState(Object(g.a)({},e.target.id,e.target.value))},a.state={title:"",shortDesc:"",longDesc:"",ingredients:[],instructions:"",imageURL:""},a}return Object(h.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return i.a.createElement("div",{className:"col"},i.a.createElement("h2",{className:"text-center"},"Here's your form, ",this.props.user),i.a.createElement("form",{onSubmit:this.handleSubmit},i.a.createElement(E.a,{controlId:"title",bsSize:"large"},i.a.createElement(f.a,null,"Recipi Title  "),i.a.createElement(b.a,{autoFocus:!0,type:"title",value:this.state.title,onChange:this.handleChange})),i.a.createElement(E.a,{controlId:"shortDesc",bsSize:"large"},i.a.createElement(f.a,null,"A short summay  "),i.a.createElement(b.a,{value:this.state.shortDesc,onChange:this.handleChange,type:"shortDesc"})),i.a.createElement(E.a,{controlId:"longDesc",bsSize:"large"},i.a.createElement(f.a,null,"A longer description  "),i.a.createElement(b.a,{value:this.state.longDesc,onChange:this.handleChange,type:"longDesc"})),i.a.createElement(E.a,{controlId:"instructions",bsSize:"large"},i.a.createElement(f.a,null,"Recipi instructions  "),i.a.createElement(b.a,{value:this.state.instructions,onChange:this.handleChange,type:"instructions"})),i.a.createElement(E.a,{controlId:"ingredients",bsSize:"large"},i.a.createElement(f.a,null,"Ingredients  "),i.a.createElement(b.a,{value:this.state.ingredients,onChange:this.handleChange,type:"ingredients"})),i.a.createElement(E.a,{controlId:"imageURL",bsSize:"large"},i.a.createElement(f.a,null,"Image URL  "),i.a.createElement(b.a,{value:this.state.imageURL,onChange:this.handleChange,type:"imageURL"})),i.a.createElement(v.a,{block:!0,bsSize:"large",type:"submit"},"Submit your Recipi!"),i.a.createElement("br",null),i.a.createElement(v.a,{onClick:this.props.goBack},"Go back")))}}]),t}(i.a.Component),w=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={token:a.props.token,isLoggedIn:!1,userData:"",recipes:[],logout:!1,isLoading:!0,inputRecipe:"",recipeDescription:""},a.goBack=a.goBack.bind(Object(m.a)(a)),a.showInput=a.showInput.bind(Object(m.a)(a)),a.loadRecipes=a.loadRecipes.bind(Object(m.a)(a)),a.plusRating=a.plusRating.bind(Object(m.a)(a)),a}return Object(h.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({isLoading:!0}),fetch("/api/account/verify",{method:"GET",headers:{"Content-Type":"application/json",token:this.state.token}}).then(function(e){return e.json()}).then(function(t){t.success?(e.setState({isLoggedIn:!0,userData:t.userData.userName,isLoading:!1}),e.loadRecipes()):e.setState({isLoggedIn:!1,isLoading:!1})})}},{key:"capitalize_Words",value:function(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}},{key:"showInput",value:function(){this.setState({inputRecipe:i.a.createElement(y.a,null,i.a.createElement("div",{className:"row align-items-center justify-content-center"},i.a.createElement(T,{user:this.state.userData,goBack:this.goBack})))})}},{key:"goBack",value:function(){this.loadRecipes(),this.setState({inputRecipe:""})}},{key:"jsUcfirst",value:function(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}},{key:"plusRating",value:function(e,t){var a=this;fetch("/api/user/didvote",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:this.state.userData,recipeTitle:e})}).then(function(e){return e.json()}).then(function(n){n.success?fetch("/api/recipes/plusrating",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e})}).then(function(e){return e.json()}).then(function(n){if(n.success){var s={};fetch("/api/recipes/find",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e})}).then(function(e){return e.json()}).then(function(e){s=e[0];var n=Object(S.a)(a.state.recipes);n[t]=i.a.createElement(C.a,{key:t,xs:"6",sm:"4"},i.a.createElement("div",{style:{textAlign:"left"}},"    ",i.a.createElement("p",null,i.a.createElement("span",{style:{fontWeight:"bold"}},a.capitalize_Words(s.title))," ",i.a.createElement("br",null),i.a.createElement("span",{style:{fontStyle:"italic"}},"By ",s.user," "),i.a.createElement("br",null)," ",a.jsUcfirst(s.description)),i.a.createElement("img",{onClick:function(){a.showDesc(s)},src:s.image,id:"imgClick",className:"img-fluid"}),i.a.createElement("p",null,"Already voted!")," ",i.a.createElement("p",null,"Rating: ",s.rating," "),i.a.createElement("br",null))),a.setState({recipes:n})})}}):alert("already voted!")})}},{key:"minusRating",value:function(e,t){var a=this;fetch("/api/user/didvote",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:this.state.userData,recipeTitle:e})}).then(function(e){return e.json()}).then(function(n){n.success?fetch("/api/recipes/minusrating",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e})}).then(function(e){return e.json()}).then(function(n){if(n.success){var s={};fetch("/api/recipes/find",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e})}).then(function(e){return e.json()}).then(function(e){s=e[0];var n=Object(S.a)(a.state.recipes);n[t]=i.a.createElement(C.a,{key:t,xs:"6",sm:"4"},i.a.createElement("div",{style:{textAlign:"left"}},"    ",i.a.createElement("p",null,i.a.createElement("span",{style:{fontWeight:"bold"}},a.capitalize_Words(s.title))," ",i.a.createElement("br",null),i.a.createElement("span",{style:{fontStyle:"italic"}},"By ",s.user," "),i.a.createElement("br",null)," ",a.jsUcfirst(s.description)),i.a.createElement("img",{onClick:function(){a.showDesc(s)},src:s.image,id:"imgClick",className:"img-fluid"}),i.a.createElement("p",null,"Already voted!")," ",i.a.createElement("p",null,"Rating: ",s.rating," "),i.a.createElement("br",null))),a.setState({recipes:n})})}}):alert("already voted!")})}},{key:"loadRecipes",value:function(){var e=this,t=this;return this.setState({isLoading:!0}),fetch("/api/recipes",{method:"GET"}).then(function(e){return e.json()}).then(function(a){var n=[];a.sort(function(e,t){return t.rating-e.rating});for(var s=function(s){var l=fetch("/api/user/didvote",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:t.state.userData,recipeTitle:a[s].title,dontChange:!0})}).then(function(e){return e.json()}).then(function(t){return t.success?i.a.createElement(C.a,{key:s,xs:"6",sm:"4"},i.a.createElement("div",{style:{textAlign:"left"}},"    ",i.a.createElement("p",null,i.a.createElement("span",{style:{fontWeight:"bold"}},e.capitalize_Words(a[s].title))," ",i.a.createElement("br",null),i.a.createElement("span",{style:{fontStyle:"italic"}},"By ",a[s].user," "),i.a.createElement("br",null)," ",e.jsUcfirst(a[s].description)),i.a.createElement("img",{onClick:function(){e.showDesc(a[s])},src:a[s].image,id:"imgClick",className:"img-fluid"}),i.a.createElement(v.a,{style:{border:"1px solid black"},variant:"light",onClick:function(){e.plusRating(a[s].title,s)}}," + "),i.a.createElement(v.a,{style:{border:"1px solid black"},variant:"light",onClick:function(){e.minusRating(a[s].title,s)}}," - ")," ",i.a.createElement("p",null,"Rating: ",a[s].rating," "),i.a.createElement("br",null))):i.a.createElement(C.a,{key:s,xs:"6",sm:"4"},i.a.createElement("div",{style:{textAlign:"left"}},"    ",i.a.createElement("p",null,i.a.createElement("span",{style:{fontWeight:"bold"}},e.capitalize_Words(a[s].title))," ",i.a.createElement("br",null),i.a.createElement("span",{style:{fontStyle:"italic"}},"By ",a[s].user," "),i.a.createElement("br",null)," ",e.jsUcfirst(a[s].description)),i.a.createElement("img",{onClick:function(){e.showDesc(a[s])},src:a[s].image,id:"imgClick",className:"img-fluid"}),i.a.createElement("p",null,"Already voted!")," ",i.a.createElement("p",null,"Rating: ",a[s].rating," "),i.a.createElement("br",null)))});n.push(l)},l=0;l<a.length;l++)s(l);Promise.all(n).then(function(t){e.setState({recipes:t,isLoading:!1})})})}},{key:"showDesc",value:function(e){for(var t=this,a=[],n=0;n<e.ingredients.length;n++)a.push(i.a.createElement("div",null,"\u2022"," ",e.ingredients[n],i.a.createElement("br",null)));var s=i.a.createElement(O,{title:this.capitalize_Words(e.title),user:e.user,imgSrc:e.image,elements:a,longDesc:e.longDescription,instructions:e.instructions,goBack:function(){t.setState({recipeDescription:""})}});this.setState({recipeDescription:s})}},{key:"logout",value:function(e){this.setState({isLoading:!0}),this.props.saveToken(""),this.setState({logout:!0,isLoggedIn:!1,isLoading:!1})}},{key:"render",value:function(){var e=this;return this.state.isLoading?i.a.createElement(y.a,null," ",i.a.createElement("div",{className:"text-center"},i.a.createElement("h2",{className:"text-center"},"Loading ... ")," ")):this.state.recipeDescription?this.state.recipeDescription:this.state.logout?i.a.createElement(p.a,{to:"/"}):this.state.inputRecipe?this.state.inputRecipe:this.state.token?this.state.isLoggedIn?i.a.createElement(y.a,null,i.a.createElement("h3",{className:"text-center"}," Welcome ",this.state.userData,", check out these Recipis!"),i.a.createElement("br",null),i.a.createElement("div",{className:"text-center"},i.a.createElement(v.a,{className:"btn",variant:"secondary",onClick:this.showInput},"Post a Recipi")),i.a.createElement("br",null),i.a.createElement(j.a,null,this.state.recipes,i.a.createElement("br",null)),i.a.createElement("div",{className:"text-center"},i.a.createElement(v.a,{className:"btn",variant:"secondary",onClick:function(){e.logout(e.state.token)}},"Logout"))):i.a.createElement(y.a,null,i.a.createElement("div",{className:"text-center"},i.a.createElement("p",null,"Loading ... "))):this.state.token?void 0:i.a.createElement("div",null,i.a.createElement(p.a,{to:"/"}))}}]),t}(i.a.Component),L=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).state={token:""},e.saveToken=e.saveToken.bind(Object(m.a)(e)),e}return Object(h.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(document.title="Recipi",""===this.state.token&&localStorage.getItem("tokenItem")){var t=localStorage.getItem("tokenItem");this.setState({token:t})}else this.state.token&&fetch("/api/account/verify",{method:"GET",headers:{"Content-Type":"application/json",token:this.state.token}}).then(function(e){return e.json()}).then(function(t){t.success?console.log("token is valid"):(localStorage.setItem("tokenItem",""),e.setState({token:""}))})}},{key:"saveToken",value:function(e){console.log("saveToken is called with token: "+e),localStorage.setItem("tokenItem",e),this.setState({token:e})}},{key:"render",value:function(){var e=this;return i.a.createElement(d.a,null,i.a.createElement("div",{className:"App"},i.a.createElement("header",{id:"headerClick",style:{backgroundColor:"#9be0d1"}},i.a.createElement("h1",{onClick:function(){window.location.href="/"},className:"Recipi"}," Recipi ")),i.a.createElement("body",{style:{backgroundColor:"#dff5f0",color:"#49786e"}},i.a.createElement(p.b,{exact:!0,path:"/",render:function(){return i.a.createElement(p.a,{to:"/login"})}}),i.a.createElement(p.b,{exact:!0,path:"/login",render:function(t){return i.a.createElement(k,Object.assign({},t,{token:e.state.token,saveToken:e.saveToken}))}}),i.a.createElement(p.b,{exact:!0,path:"/home",render:function(t){return i.a.createElement(w,Object.assign({},t,{token:e.state.token,saveToken:e.saveToken}))}}),i.a.createElement("br",null)),i.a.createElement("footer",{style:{backgroundColor:"#9be0d1"}},"Website built by Nicolai Antonov, 2019")))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(44);l.a.render(i.a.createElement(L,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[33,1,2]]]);
//# sourceMappingURL=main.b49fecbc.chunk.js.map
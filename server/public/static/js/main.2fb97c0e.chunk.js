(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{38:function(e,t,a){e.exports=a(50)},43:function(e,t,a){},44:function(e,t,a){},50:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),s=a(29),r=a.n(s),l=(a(43),a(9)),o=a(10),c=a(13),u=a(11),m=a(14),h=a(12),p=(a(44),a(18)),d=a(16),g=a(19),E=a(33),f=a(34),y=a(36),b=a(54),v=a(51),k=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){a.setState(Object(g.a)({},e.target.id,e.target.value))},a.register=function(e){a.setState({registerForm:!0})},a.backToLogin=function(e){a.setState({registerForm:!1})},a.handleLogin=function(e){a.setState({isLoading:!0}),e.preventDefault();var t=a.state,n=t.email,i=t.password;fetch("/api/account/signin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:i})}).then(function(e){return e.json()}).then(function(e){e.success?(a.props.saveToken(e.token),localStorage.setItem("tokenItem",e.token),a.setState({toHome:!0,isLoading:!1})):(a.setState({signUpError:e.message}),alert("invalid login"),a.setState({isLoading:!1}))})},a.handleSubmit=function(e){a.setState({isLoading:!0}),e.preventDefault();var t=a.state,n=t.email,i=t.password,s=t.username;fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:i,username:s})}).then(function(e){return e.json()}).then(function(e){e.success?(a.setState({signUpError:e.message,isLoading:!1,email:"",password:"",username:""}),a.setState({registerForm:!1})):(a.setState({signUpError:e.message,isLoading:!1}),alert("Username or email taken! Try again."))})},a.state={email:"",password:"",username:"",isLoading:!0,signUpError:"",registerForm:!1,token:a.props.token,validSession:!1,toHome:!1},a}return Object(h.a)(t,e),Object(o.a)(t,[{key:"validateForm",value:function(){return this.state.email.length>0&&this.state.password.length>0}},{key:"componentDidMount",value:function(){var e=this;this.setState({isLoading:!0}),fetch("/api/account/verify",{method:"GET",headers:{"Content-Type":"application/json",token:this.state.token}}).then(function(e){return e.json()}).then(function(t){t.success?e.setState({validSession:!0}):e.setState({validSession:!1}),e.setState({isLoading:!1})})}},{key:"render",value:function(){return this.state.toHome?i.a.createElement(d.a,{to:"/home"}):this.state.isLoading?i.a.createElement(v.a,null," ",i.a.createElement("div",{className:"text-center"},i.a.createElement("h2",{className:"text-center"},"Loading ... ")," ")):this.state.registerForm?i.a.createElement(v.a,null,i.a.createElement("div",{className:"Login"},i.a.createElement("form",{onSubmit:this.handleSubmit},i.a.createElement(E.a,{controlId:"email",bsSize:"large"},i.a.createElement(f.a,null,"Email  "),i.a.createElement(y.a,{autoFocus:!0,type:"email",value:this.state.email,onChange:this.handleChange})),i.a.createElement(E.a,{controlId:"username",bsSize:"large"},i.a.createElement(f.a,null,"Username  "),i.a.createElement(y.a,{value:this.state.username,onChange:this.handleChange,type:"username"})),i.a.createElement(E.a,{controlId:"password",bsSize:"large"},i.a.createElement(f.a,null,"Password  "),i.a.createElement(y.a,{value:this.state.password,onChange:this.handleChange,type:"password"})),i.a.createElement(b.a,{block:!0,bsSize:"large",disabled:!this.validateForm(),type:"submit"},"Register"),i.a.createElement("br",null),i.a.createElement(b.a,{block:!0,bsSize:"small",type:"submit",onClick:this.backToLogin},"Go Back")))):this.state.token&&!1!==this.state.validSession?i.a.createElement("div",null,i.a.createElement("p",null,"Signed in"),i.a.createElement("div",null,i.a.createElement(d.a,{to:"/home"}))):i.a.createElement(v.a,null,i.a.createElement("div",null,i.a.createElement("p",null,"Login here: "),i.a.createElement("form",{onSubmit:this.handleLogin},i.a.createElement(E.a,{controlId:"email",bsSize:"large"},i.a.createElement(f.a,null,"Email  "),i.a.createElement(y.a,{autoFocus:!0,type:"email",value:this.state.email,onChange:this.handleChange})),i.a.createElement(E.a,{controlId:"password",bsSize:"large"},i.a.createElement(f.a,null,"Password  "),i.a.createElement(y.a,{value:this.state.password,onChange:this.handleChange,type:"password"})),i.a.createElement(b.a,{block:!0,bsSize:"large",disabled:!this.validateForm(),type:"submit"},"Login")),i.a.createElement("br",null),i.a.createElement(b.a,{block:!0,bsSize:"large",type:"button",onClick:this.register},"Register")))}}]),t}(n.Component),S=a(24),C=a(35),j=a(53),R=a(52),w=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={ratingButtons:a.props.ratingButtons},a}return Object(h.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return i.a.createElement(v.a,null,i.a.createElement("h1",null,this.props.title)," ",i.a.createElement("p",null,"by ",this.props.user)," ",i.a.createElement("img",{className:"img-fluid",src:this.props.imgSrc})," ",this.state.ratingButtons," ",this.props.elements," ",i.a.createElement("br",null)," ",i.a.createElement("p",null,this.props.longDesc),i.a.createElement("p",null,this.props.instructions),i.a.createElement("br",null),i.a.createElement(b.a,{onClick:this.props.goBack},"Go Back"))}}]),t}(i.a.Component),T=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){a.setState({isLoading:!0}),e.preventDefault();var t=a.state,n=t.title,i=t.shortDesc,s=t.longDesc,r=t.ingredients,l=t.instructions,o=t.imageURL,c=r.replace(/\s*,\s*/g,",").split(",");c=c.map(function(e){return""+e[0].toUpperCase()+e.slice(1)}),fetch("/api/recipes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:a.props.token,user:a.props.user,title:n,description:i,longDescription:s,ingredients:c,instructions:l,image:o})}).then(function(e){return e.json()}).then(function(e){e.success?(alert("Recipi saved!"),a.props.goBack()):alert("Failed! Server error.")})},a.handleChange=function(e){a.setState(Object(g.a)({},e.target.id,e.target.value))},a.state={title:"",shortDesc:"",longDesc:"",ingredients:[],instructions:"",imageURL:""},a}return Object(h.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return i.a.createElement("div",{className:"col"},i.a.createElement("h2",{className:"text-center"},"Here's your form, ",this.props.user),i.a.createElement("form",{onSubmit:this.handleSubmit},i.a.createElement(E.a,{controlId:"title",bsSize:"large"},i.a.createElement(f.a,null,"Recipi Title  "),i.a.createElement(y.a,{autoFocus:!0,type:"title",value:this.state.title,onChange:this.handleChange})),i.a.createElement(E.a,{controlId:"shortDesc",bsSize:"large"},i.a.createElement(f.a,null,"A short summay  "),i.a.createElement(y.a,{value:this.state.shortDesc,onChange:this.handleChange,type:"shortDesc"})),i.a.createElement(E.a,{controlId:"longDesc",bsSize:"large"},i.a.createElement(f.a,null,"A longer description  "),i.a.createElement(y.a,{value:this.state.longDesc,onChange:this.handleChange,type:"longDesc"})),i.a.createElement(E.a,{controlId:"instructions",bsSize:"large"},i.a.createElement(f.a,null,"Recipi instructions  "),i.a.createElement(y.a,{value:this.state.instructions,onChange:this.handleChange,type:"instructions"})),i.a.createElement(E.a,{controlId:"ingredients",bsSize:"large"},i.a.createElement(f.a,null,"Ingredients  "),i.a.createElement(y.a,{value:this.state.ingredients,onChange:this.handleChange,type:"ingredients"})),i.a.createElement(E.a,{controlId:"imageURL",bsSize:"large"},i.a.createElement(f.a,null,"Image URL  "),i.a.createElement(y.a,{value:this.state.imageURL,onChange:this.handleChange,type:"imageURL"})),i.a.createElement(b.a,{block:!0,bsSize:"large",type:"submit"},"Submit your Recipi!"),i.a.createElement("br",null),i.a.createElement(b.a,{onClick:this.props.goBack},"Go back")))}}]),t}(i.a.Component),O=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleSearch=function(e){var t="";e?(t=e.target.value,a.setState({searchTerm:t})):t=a.state.searchTerm;var n=t.toLowerCase(),s=a.state.recipes.map(function(e){return a.state.recipeTitleByIndex[e.key].includes(n)?e:i.a.createElement("div",null)});a.setState({filtRecipes:s})},a.state={token:a.props.token,isLoggedIn:!1,userData:"",recipes:[],logout:!1,isLoading:!0,inputRecipe:"",recipeDescription:"",searchTerm:"",recipeTitleByIndex:[],filtRecipes:[],myRecipes:[i.a.createElement("div",null,i.a.createElement("h3",null,"Nothing to show!"))],showMyRecipes:!1,toggleMyRecipesText:"Show My Recipis"},a.goBack=a.goBack.bind(Object(m.a)(a)),a.showInput=a.showInput.bind(Object(m.a)(a)),a.loadRecipes=a.loadRecipes.bind(Object(m.a)(a)),a.plusRating=a.plusRating.bind(Object(m.a)(a)),a.toggleMyRecipes=a.toggleMyRecipes.bind(Object(m.a)(a)),a}return Object(h.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({isLoading:!0}),fetch("/api/account/verify",{method:"GET",headers:{"Content-Type":"application/json",token:this.state.token}}).then(function(e){return e.json()}).then(function(t){t.success?(e.setState({isLoggedIn:!0,userData:t.userData.userName,isLoading:!1}),e.loadRecipes()):e.setState({isLoggedIn:!1,isLoading:!1})})}},{key:"capitalize_Words",value:function(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}},{key:"showInput",value:function(){this.setState({inputRecipe:i.a.createElement(v.a,null,i.a.createElement("div",{className:"row align-items-center justify-content-center"},i.a.createElement(T,{user:this.state.userData,token:this.state.token,goBack:this.goBack})))})}},{key:"goBack",value:function(){this.loadRecipes(),this.setState({inputRecipe:""})}},{key:"jsUcfirst",value:function(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}},{key:"plusRating",value:function(e,t){var a=this,n=this;fetch("/api/user/didvote",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:this.state.userData,recipeTitle:e,token:this.state.token})}).then(function(e){return e.json()}).then(function(s){s.success?fetch("/api/recipes/plusrating",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e,token:a.state.token})}).then(function(e){return e.json()}).then(function(s){if(s.success){var r={};fetch("/api/recipes/find",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e,token:a.state.token})}).then(function(e){return e.json()}).then(function(e){r=e[0];var a=Object(S.a)(n.state.recipes),s=i.a.createElement("div",null,i.a.createElement("p",null,"Already voted!")," ",i.a.createElement("p",null,"Rating: ",r.rating," "));a[t]=i.a.createElement(C.a,{key:t,xs:"6",sm:"4"},i.a.createElement("div",{style:{textAlign:"left"}},"    ",i.a.createElement("p",null,i.a.createElement("span",{style:{fontWeight:"bold"}},n.capitalize_Words(r.title))," ",i.a.createElement("br",null),i.a.createElement("span",{style:{fontStyle:"italic"}},"By ",r.user," "),i.a.createElement("br",null)," ",n.jsUcfirst(r.description)),i.a.createElement("img",{onClick:function(){n.showDesc(r,s)},src:r.image,id:"imgClick",className:"img-fluid",style:{boxShadow:"1px 3px 1px #9E9E9E"}}),s,i.a.createElement("br",null))),n.setState({recipes:a}),n.state.recipeDescription&&(n.setState({recipeDescription:""}),n.showDesc(r,s)),n.state.searchTerm&&n.handleSearch(),n.state.showMyRecipes&&n.loadRecipes()})}}):alert("already voted!")})}},{key:"minusRating",value:function(e,t){var a=this,n=this;fetch("/api/user/didvote",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:this.state.userData,recipeTitle:e,token:this.state.token})}).then(function(e){return e.json()}).then(function(s){s.success?fetch("/api/recipes/minusrating",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e,token:a.state.token})}).then(function(e){return e.json()}).then(function(s){if(s.success){var r={};fetch("/api/recipes/find",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e,token:a.state.token})}).then(function(e){return e.json()}).then(function(e){r=e[0];var a=Object(S.a)(n.state.recipes),s=i.a.createElement("div",null,i.a.createElement("p",null,"Already voted!")," ",i.a.createElement("p",null,"Rating: ",r.rating," "));a[t]=i.a.createElement(C.a,{key:t,xs:"6",sm:"4"},i.a.createElement("div",{style:{textAlign:"left"}},"    ",i.a.createElement("p",null,i.a.createElement("span",{style:{fontWeight:"bold"}},n.capitalize_Words(r.title))," ",i.a.createElement("br",null),i.a.createElement("span",{style:{fontStyle:"italic"}},"By ",r.user," "),i.a.createElement("br",null)," ",n.jsUcfirst(r.description)),i.a.createElement("img",{onClick:function(){n.showDesc(r,s)},src:r.image,id:"imgClick",className:"img-fluid",style:{boxShadow:"1px 3px 1px #9E9E9E"}}),s,i.a.createElement("br",null))),n.setState({recipes:a}),n.state.recipeDescription&&(n.setState({recipeDescription:""}),n.showDesc(r,s)),n.state.searchTerm&&n.handleSearch(),n.state.showMyRecipes&&n.loadRecipes()})}}):alert("already voted!")})}},{key:"loadRecipes",value:function(){var e=this,t=this;return this.setState({isLoading:!0}),fetch("/api/recipes",{method:"GET",headers:{token:this.state.token}}).then(function(e){return e.json()}).then(function(a){var n=[],s=[];a.sort(function(e,t){return t.rating-e.rating});for(var r=function(r){var l=fetch("/api/user/didvote",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:t.state.userData,recipeTitle:a[r].title,dontChange:!0,token:e.state.token})}).then(function(e){return e.json()}).then(function(n){var l="";l=n.success?i.a.createElement("div",null,i.a.createElement(b.a,{style:{border:"1px solid black"},variant:"light",onClick:function(){e.plusRating(a[r].title,r)}}," + "),i.a.createElement(b.a,{style:{border:"1px solid black"},variant:"light",onClick:function(){e.minusRating(a[r].title,r)}}," - ")," ",i.a.createElement("p",null,"Rating: ",a[r].rating," ")):i.a.createElement("div",null,i.a.createElement("p",null,"Already voted!")," ",i.a.createElement("p",null,"Rating: ",a[r].rating," "));var o=t.state.recipeTitleByIndex;return o[r]=a[r].title,t.setState({recipeTitleByIndex:o}),t.state.userData===a[r].user&&(console.log("adding a recipe to the myRecipes array. recipe author is: "+a[r].user+" and current user is: "+t.state.userData),s.push(i.a.createElement(C.a,{key:r,xs:"6",sm:"4"},i.a.createElement("div",{style:{textAlign:"left"}},"    ",i.a.createElement("p",null,i.a.createElement("span",{style:{fontWeight:"bold"}},e.capitalize_Words(a[r].title))," ",i.a.createElement("br",null),i.a.createElement("span",{style:{fontStyle:"italic"}},"By ",a[r].user," "),i.a.createElement("br",null)," ",e.jsUcfirst(a[r].description)),i.a.createElement("img",{onClick:function(){e.showDesc(a[r],l)},src:a[r].image,id:"imgClick",className:"img-fluid",style:{boxShadow:"1px 3px 1px #9E9E9E"}}),l,i.a.createElement("br",null))))),i.a.createElement(C.a,{key:r,xs:"6",sm:"4"},i.a.createElement("div",{style:{textAlign:"left"}},"    ",i.a.createElement("p",null,i.a.createElement("span",{style:{fontWeight:"bold"}},e.capitalize_Words(a[r].title))," ",i.a.createElement("br",null),i.a.createElement("span",{style:{fontStyle:"italic"}},"By ",a[r].user," "),i.a.createElement("br",null)," ",e.jsUcfirst(a[r].description)),i.a.createElement("img",{onClick:function(){e.showDesc(a[r],l)},src:a[r].image,id:"imgClick",className:"img-fluid",style:{boxShadow:"1px 3px 1px #9E9E9E"}}),l,i.a.createElement("br",null)))});n.push(l)},l=0;l<a.length;l++)r(l);Promise.all(n).then(function(t){s[0]||s.push(i.a.createElement("div",null,i.a.createElement("h3",null,"Nothing to show!"))),e.setState({recipes:t,myRecipes:s,isLoading:!1})})})}},{key:"showDesc",value:function(e,t){for(var a=this,n=[],s=0;s<e.ingredients.length;s++)n.push(i.a.createElement("div",null,"\u2022"," ",e.ingredients[s],i.a.createElement("br",null)));var r=i.a.createElement(w,{ratingButtons:t,title:this.capitalize_Words(e.title),user:e.user,imgSrc:e.image,elements:n,longDesc:e.longDescription,instructions:e.instructions,goBack:function(){a.setState({recipeDescription:""})}});this.setState({recipeDescription:r})}},{key:"toggleMyRecipes",value:function(){this.state.showMyRecipes?this.setState({showMyRecipes:!1,toggleMyRecipesText:"Show My Recipis"}):this.setState({showMyRecipes:!0,toggleMyRecipesText:"Show All Recipis"})}},{key:"logout",value:function(e){this.setState({isLoading:!0}),this.props.saveToken(""),this.setState({logout:!0,isLoggedIn:!1,isLoading:!1})}},{key:"render",value:function(){var e=this;if(this.state.isLoading)return i.a.createElement(v.a,null," ",i.a.createElement("div",{className:"text-center"},i.a.createElement("h2",{className:"text-center"},"Loading ... ")," "));if(this.state.recipeDescription)return this.state.recipeDescription;if(this.state.logout)return i.a.createElement(d.a,{to:"/"});if(this.state.inputRecipe)return this.state.inputRecipe;if(this.state.token){if(this.state.isLoggedIn){var t="";return t=""!==this.state.searchTerm?this.state.filtRecipes:this.state.recipes,this.state.showMyRecipes&&(t=this.state.myRecipes),i.a.createElement(v.a,null,i.a.createElement("h3",{className:"text-center"}," Welcome ",this.state.userData,", check out these Recipis!"),i.a.createElement(j.a,null,i.a.createElement(j.a.Group,{controlId:"formSearchTerms"},i.a.createElement(j.a.Control,{value:this.state.searchTerm,onChange:this.handleSearch,type:"search",placeholder:"Search Recipi titles ..."}))),i.a.createElement("br",null),i.a.createElement("div",{className:"text-center"},i.a.createElement(b.a,{className:"btn",variant:"secondary",onClick:this.showInput},"Post a Recipi"),"    ",i.a.createElement("span",null," "),i.a.createElement(b.a,{className:"btn",variant:"secondary",onClick:this.toggleMyRecipes},this.state.toggleMyRecipesText)),i.a.createElement("br",null),i.a.createElement(R.a,null,t,i.a.createElement("br",null)),i.a.createElement("div",{className:"text-center"},i.a.createElement(b.a,{className:"btn",variant:"secondary",onClick:function(){e.logout(e.state.token)}},"Logout")))}return i.a.createElement(v.a,null,i.a.createElement("div",{className:"text-center"},i.a.createElement("p",null,"Loading ... ")))}return this.state.token?void 0:i.a.createElement("div",null,i.a.createElement(d.a,{to:"/"}))}}]),t}(i.a.Component),x=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).state={token:""},e.saveToken=e.saveToken.bind(Object(m.a)(e)),e}return Object(h.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(document.title="Recipi",""===this.state.token&&localStorage.getItem("tokenItem")){var t=localStorage.getItem("tokenItem");this.setState({token:t})}else this.state.token&&fetch("/api/account/verify",{method:"GET",headers:{"Content-Type":"application/json",token:this.state.token}}).then(function(e){return e.json()}).then(function(t){t.success?console.log("token is valid"):e.saveToken("")})}},{key:"saveToken",value:function(e){console.log("saveToken is called with token: "+e),localStorage.setItem("tokenItem",e),this.setState({token:e})}},{key:"render",value:function(){var e=this;return i.a.createElement(p.a,null,i.a.createElement("div",{className:"App"},i.a.createElement("header",{id:"headerClick",style:{backgroundColor:"#6dc4ed"}},i.a.createElement("h1",{onClick:function(){window.location.href="/"},className:"Recipi"}," Recipi ")),i.a.createElement("body",{style:{backgroundColor:"#e6f5fc",color:"#1c7fad",fontFamily:"Quicksand"}},i.a.createElement(d.b,{exact:!0,path:"/",render:function(){return i.a.createElement(d.a,{to:"/login"})}}),i.a.createElement(d.b,{exact:!0,path:"/login",render:function(t){return i.a.createElement(k,Object.assign({},t,{token:e.state.token,saveToken:e.saveToken}))}}),i.a.createElement(d.b,{exact:!0,path:"/home",render:function(t){return i.a.createElement(O,Object.assign({},t,{token:e.state.token,saveToken:e.saveToken}))}}),i.a.createElement("br",null)),i.a.createElement("footer",{style:{backgroundColor:"#6dc4ed"}},"Website built by Nicolai Antonov, 2019")))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(49);r.a.render(i.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[38,1,2]]]);
//# sourceMappingURL=main.2fb97c0e.chunk.js.map